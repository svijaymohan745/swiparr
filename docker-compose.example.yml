services:
  swiparr:
    image: ghcr.io/m3sserstudi0s/swiparr:latest
    container_name: swiparr
    restart: unless-stopped
    environment:
      # REQUIRED: The internal URL of your Jellyfin server (accessible by the container)
      # Example: http://192.168.1.10:8096 or http://jellyfin:8096
      # Note: If your Jellyfin is behind a reverse proxy on the same network, 
      # use the container name and port here instead of the public domain.
      - JELLYFIN_URL=http://jellyfin:8096
      
      # OPTIONAL: The public URL of your Jellyfin server (accessible by your browser)
      # Used for loading images and redirecting to the Jellyfin login.
      # Defaults to JELLYFIN_URL if not provided.
      # - JELLYFIN_PUBLIC_URL=https://jellyfin.example.com
      
      # OPTIONAL: A long random string (at least 32 chars) for session encryption.
      # Generated automatically and stored in the database if not provided.
      # - AUTH_SECRET=your_random_secret_here
      
      # OPTIONAL: Database location (internal to container)
      # Default: file:/app/data/swiparr.db
      - DATABASE_URL=file:/app/data/swiparr.db
      
      # OPTIONAL: Use Jellyfin Watchlist instead of Favorites
      # Requires Jellyfin Enhanced plugin or similar script.
      - JELLYFIN_USE_WATCHLIST=false

      # OPTIONAL: Use secure cookies (set to true if using HTTPS)
      # IMPORTANT: When using a reverse proxy, ensure it passes the "Host" header.
      - USE_SECURE_COOKIES=false
      
      # OPTIONAL: The hostname the server binds to
      # Default: 0.0.0.0 (listens on all interfaces)
      - HOSTNAME=0.0.0.0
      
      # OPTIONAL: Run as a specific user/group ID
      # Useful for matching host permissions on mounted volumes
      # - PUID=1000
      # - PGID=1000
    volumes:
      # Persist database and other data
      - ./swiparr-data:/app/data
    ports:
      - 4321:4321
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:4321/api/health"]
      interval: 30s
      timeout: 5s
      retries: 3
      start_period: 10s
